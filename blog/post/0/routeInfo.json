{"template":"__react_static_root__/src/containers/Post","sharedHashesByProp":{},"data":{"post":{"id":0,"userId":1,"title":"nodejs递归遍历md文件","year":"2020","month":"7","path":"D:/phpstudy_pro/WWW/xiaoxiao/cat/src/md/2020/7/nodejs递归遍历md文件.md","body":"## nodejs遍历md文件，并生成博客列表\r\n\r\n我的新版博客打算使用`react-static`+`markdown`，所以写了个递归遍历`md`文件的方法。\r\n\r\n``` js\r\nvar id = 0;\r\n\r\nfunction readFileList(dir, filesList = []) {\r\n    // 列出所有文件或目录\r\n    const files = fs.readdirSync(dir);\r\n    // 遍历\r\n    files.forEach((item, index) => {\r\n        // 计算绝对路径\r\n        var fullPath = path.join(dir, item);\r\n        // 获取状态\r\n        const stat = fs.statSync(fullPath);\r\n        // 如果是目录\r\n        if (stat.isDirectory()) {\r\n            // 递归\r\n            readFileList(path.join(dir, item), filesList);\r\n        } else {\r\n            // 否则是文件 判断文件后缀名\r\n            if (item.slice(-3).toLowerCase() == \".md\") {\r\n                // 文件分隔符\r\n                fullPath = fullPath.replace(/\\\\/g, \"/\");\r\n                // 分割\r\n                var path_sp = fullPath.split(\"/\");\r\n                // 添加到列表\r\n                filesList.push({\r\n                    id: id++,\r\n                    userId: 1,\r\n                    title: item.slice(0, -3),\r\n                    year: path_sp[path_sp.length - 3],\r\n                    month: path_sp[path_sp.length - 2],\r\n                    path: fullPath,\r\n                    body: fs.readFileSync(fullPath).toString(),\r\n                });\r\n            }\r\n        }\r\n    });\r\n    return filesList;\r\n}\r\n// 实参\r\nvar blog_md_list = [];\r\n// 递归遍历md文件\r\nreadFileList(path.join(__dirname, \"public\", \"md\"), blog_md_list);\r\n```\r\n"}},"path":"blog/post/0"}
